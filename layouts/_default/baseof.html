<!doctype html>
<html lang="en">
<head>
  {{ $metaTitle := cond .IsHome .Site.Title (printf "%s | %s" .Title .Site.Title) }}
  {{ $metaDescription := .Params.summary | default .Site.Params.description }}
  {{ $metaURL := .Permalink }}
  {{ $metaType := cond .IsHome "website" "article" }}
  {{ $scratch := newScratch }}
  {{ $scratch.Set "metaImage" "" }}
  {{ $scratch.Set "metaImageAlt" .Title }}
  {{ with .Params.images }}
    {{ if gt (len .) 0 }}
      {{ $lead := index . 0 }}
      {{ with index $lead "src" }}
        {{ if hasPrefix . "http://" }}
          {{ $scratch.Set "metaImage" . }}
        {{ else if hasPrefix . "https://" }}
          {{ $scratch.Set "metaImage" . }}
        {{ else if hasPrefix . "/" }}
          {{ $scratch.Set "metaImage" (. | absURL) }}
        {{ else }}
          {{ with $.Resources.GetMatch . }}
            {{ with .Fill "1200x630 Center" }}
              {{ $scratch.Set "metaImage" .Permalink }}
            {{ end }}
          {{ else }}
            {{ $scratch.Set "metaImage" (printf "%s%s" $.Permalink .) }}
          {{ end }}
        {{ end }}
      {{ end }}
      {{ with index $lead "alt" }}
        {{ $scratch.Set "metaImageAlt" . }}
      {{ end }}
    {{ end }}
  {{ end }}
  {{ $metaImage := $scratch.Get "metaImage" }}
  {{ $metaImageAlt := $scratch.Get "metaImageAlt" }}
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ $metaTitle }}</title>
  <meta name="description" content="{{ $metaDescription }}">
  <meta property="og:site_name" content="{{ .Site.Title }}">
  <meta property="og:type" content="{{ $metaType }}">
  <meta property="og:title" content="{{ $metaTitle }}">
  <meta property="og:description" content="{{ $metaDescription }}">
  <meta property="og:url" content="{{ $metaURL }}">
  {{ with $metaImage }}
    <meta property="og:image" content="{{ . }}">
    <meta property="og:image:alt" content="{{ $metaImageAlt }}">
  {{ end }}
  <meta name="twitter:card" content="{{ if $metaImage }}summary_large_image{{ else }}summary{{ end }}">
  <meta name="twitter:title" content="{{ $metaTitle }}">
  <meta name="twitter:description" content="{{ $metaDescription }}">
  {{ with $metaImage }}
    <meta name="twitter:image" content="{{ . }}">
    <meta name="twitter:image:alt" content="{{ $metaImageAlt }}">
  {{ end }}
  <link rel="alternate" type="application/rss+xml" title="{{ .Site.Title }}" href="{{ "/index.xml" | relURL }}">
  <link rel="stylesheet" href="{{ "/css/base.css" | relURL }}">
  {{ if eq .Section "previews" }}
    <link rel="stylesheet" href="{{ "/css/preview-options.css" | relURL }}">
  {{ end }}
</head>
<body>
  <header class="site-header">
    <div class="shell">
      <a class="brand" href="{{ "/" | relURL }}">{{ .Site.Title }}</a>
      <nav class="site-nav" aria-label="Primary">
        {{ range .Site.Menus.main }}
          {{ $menuURL := .URL | relURL }}
          {{ $isActive := false }}
          {{ if eq $menuURL "/" }}
            {{ $isActive = $.IsHome }}
          {{ else }}
            {{ $isActive = hasPrefix $.RelPermalink $menuURL }}
          {{ end }}
          <a class="{{ if $isActive }}is-active{{ end }}" href="{{ $menuURL }}" {{ if $isActive }}aria-current="page"{{ end }}>{{ .Name }}</a>
        {{ end }}
      </nav>
    </div>
  </header>
  <main class="shell">
    {{ block "main" . }}{{ end }}
  </main>
  <footer class="site-footer">
    <div class="shell">
      <a href="{{ "/index.xml" | relURL }}">RSS</a>
    </div>
  </footer>
</body>
</html>
